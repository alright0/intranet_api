{% extends 'base.html' %}

<!DOCTYPE html>

<head>
    <title>{% block title %}Statistics{% endblock %}</title>
    {% block javascript %}
    {{ super() }}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    {% endblock %}
</head>

<body>

    <main>
        {% block content %}
        <form action="/ajax" id="form1" method="post">
            <input type="text" id="nm" value="Имя">
            <input type="text" id="ph" value="номер">

            <input type="submit" value="Отправить" />
        </form>
        <div id="msg"></div>
        <script>
            /* переопределить поведение кнопки "Отправить" */
            $(document).ready(function () {
                $("#form1").submit(function (event) {
                    sendAjaxForm("form1", "msg");
                    event.preventDefault();
                });
            });


            /* отправка формы через ajax */
            function sendAjaxForm(form_ajax, msg) {
                var form = $("#" + form_ajax);
                $.ajax({
                    type: form.attr('method'),
                    url: form.attr('action'),
                    data: form.serialize(),
                    success: function (response) {
                        var json = jQuery.parseJSON(response);
                        $('#' + msg).html(json.msg);
                        if (json.success == 'true') {
                            form.trigger('reset');
                        }
                        else {
                            alert("Что-то пошло не так!");
                            console.log("Ошибка");
                        }
                    },
                    error: function (error) {
                        console.log(error);
                    }
                });
            }
        </script>
        {% endblock %}
    </main>

</body>