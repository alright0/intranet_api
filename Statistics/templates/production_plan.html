{% extends 'base.html' %}

<!DOCTYPE html>

<head>
    <title>{% block title %}Production Plan{% endblock %}</title>
    {% block javascript %}
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    {% endblock %}
</head>

<body>


    <main>
        {% block nav %}{% endblock %}
        {% block content %}
        <div class="production_plan">
            <div class="production_plan_graphs">
                <div id='main_graph'>
                    <script>
                        (function () {
                            var d3 = Plotly.d3;

                            /* ширина и высота в процентах*/
                            var WIDTH = 98,
                                HEIGHT = 50;

                            /* ширина и высота родительского элемента*/
                            var gd3 = d3.select('#main_graph')
                                .style({
                                    width: WIDTH + '%',
                                    height: HEIGHT + 'vh',
                                });

                            var gd = gd3.node();

                            /*встраивание переменной jinja2*/
                            var graph_json = {{ plot | safe
                        }};

                        /*здесь создается график*/
                        graph = Plotly.plot('main_graph', graph_json, {},);

                        /* событие изменения ширины*/
                        window.onresize = function (event) {
                            gd3.style({
                                width: WIDTH + '%',
                                height: HEIGHT + 'vh',
                            });
                            gd = gd3.node()
                            Plotly.Plots.resize(gd);;
                        };
                        }) ();
                    </script>
                    <div class="production_plan_table_av">
                        {{table_average|safe}}
                    </div>
                </div>
            </div>
            <div class="production_plan_table">{{table|safe}}</div>
        </div>

        {% endblock %}
    </main>




</body>

</html>